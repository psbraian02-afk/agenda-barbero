<!DOCTYPE html> 
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>The Barber Shop | Barber√≠a Profesional</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@200;300;400;600&display=swap" rel="stylesheet">

<style>
:root {
  --gold: #c5a059; 
  --gold-light: #e2c286;
  --gold-glow: rgba(197, 160, 89, 0.5);
  --navy: #0a1118; 
  --bg-white: #ffffff;
  --bg-soft: #f4f4f2; 
  --text-dark: #1a1a1a;
  --text-muted: #666666;
  --border: rgba(197, 160, 89, 0.3);
}

* { box-sizing: border-box; }
html { scroll-behavior: smooth; }

body {
  margin: 0;
  padding: 0;
  background-color: var(--bg-soft);
  color: var(--text-dark);
  font-family: 'Inter', sans-serif;
  overflow-x: hidden;
}

::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-thumb { background: var(--gold); }

.main-wrapper {
  width: 100%;
  min-height: 100vh;
}

.hero-section {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px 10px;
}

.app {
  width: 100%;
  max-width: 1000px;
  min-height: 750px;
  background: var(--bg-white);
  border: 1px solid var(--border);
  box-shadow: 0 40px 100px rgba(0,0,0,0.1);
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.screen {
  position: absolute;
  inset: 0;
  padding: 30px 15px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 25px;
  opacity: 0;
  transform: translateY(10px);
  pointer-events: none;
  transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
  background: var(--bg-white); 
}

.screen.active {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
  position: relative; 
}

/* --- ESTILO BARBER√çA --- */
.logo-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 10px;
}

.logo-circle {
  width: 90px;
  height: 90px;
  border: 3px double var(--gold);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 20px;
  position: relative;
  background: var(--navy);
}

.logo-symbol {
  width: 60%; 
  filter: invert(1); 
}

h1.brand {
  font-family: 'Cinzel', serif;
  font-size: clamp(22px, 5vw, 32px);
  font-weight: 700;
  color: var(--navy);
  margin: 0;
  letter-spacing: 4px;
  text-transform: uppercase;
  text-align: center;
}

.brand-divider {
  display: flex;
  align-items: center;
  gap: 15px;
  width: 100%;
  max-width: 300px;
  margin-top: 5px;
}

.line {
  height: 1px;
  background: linear-gradient(to right, transparent, var(--gold), transparent);
  flex: 1;
}

h2 { 
  font-family: 'Cinzel', serif;
  font-weight: 400; 
  letter-spacing: 3px; 
  text-transform: uppercase; 
  font-size: 18px; 
  color: var(--gold);
  margin-bottom: 20px;
  border-bottom: 1px solid var(--border);
  padding-bottom: 10px;
}

button {
  padding: 15px 30px;
  border: 1px solid var(--navy);
  background: var(--navy);
  color: white;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 2px;
  font-size: 11px;
  cursor: pointer;
  transition: 0.3s;
}

button:hover:not(:disabled) {
  background: var(--gold);
  border-color: var(--gold);
  box-shadow: 0 0 20px var(--gold-glow);
  transform: translateY(-2px);
}

button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    border-color: #ccc;
    background: #eee;
    color: #999;
}

button.secondary {
    background: transparent;
    color: var(--navy);
}

input {
  background: transparent;
  border: 1px solid #eee;
  padding: 15px;
  color: var(--text-dark);
  width: 100%;
  max-width: 280px;
  text-align: center;
  font-size: 14px;
}

/* --- GRID SERVICIOS --- */
.service-options {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  width: 100%;
  max-height: 450px;
  overflow-y: auto;
  padding: 10px;
}

.service-card {
  background: #fff;
  border: 1px solid #eee;
  padding: 0;
  transition: 0.3s;
  text-align: center;
  cursor: pointer;
  overflow: hidden;
}

.service-card img {
  width: 100%;
  height: 120px;
  object-fit: cover;
  display: block;
}

.service-card .info { padding: 10px; }

/* --- ADMIN PANEL ESTILOS --- */
.admin-card {
  background: #fff;
  border: 1px solid #eee;
  border-left: 4px solid var(--gold);
  margin-bottom: 12px;
  padding: 15px;
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.admin-info-client { text-align: left; }
.admin-info-client strong { color: var(--navy); font-size: 14px; }
.admin-info-client p { margin: 2px 0; font-size: 12px; color: var(--text-muted); }

.about-section {
  padding: 80px 20px;
  max-width: 1100px;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

</style>
</head>
<body>

<div class="main-wrapper">
  <section class="hero-section">
    <div class="app">

      <div class="screen active" id="home">
        <div class="logo-container">
          <div class="logo-circle">
            <img src="https://cdn-icons-png.flaticon.com/512/483/483488.png" alt="Logo" class="logo-symbol">
          </div>
          <h1 class="brand">Classic Blade</h1>
          <div class="brand-divider">
            <div class="line"></div>
            <p style="letter-spacing: 3px; color: var(--text-muted); font-size: 9px; font-weight: 400; text-transform: uppercase; margin: 0;">Master Barber Studio</p>
            <div class="line"></div>
          </div>
        </div>
        <p style="letter-spacing: 2px; color: var(--gold); font-size: 12px; font-weight: 600; text-transform: uppercase; margin-top: -10px;">Excelencia en cada corte</p>
        <div style="display:flex; flex-direction:column; gap:15px; width: 260px; margin-top: 20px;">
          <button onclick="tryGoAgenda()">Reservar Turno</button>
          <button class="secondary" style="border:none; font-size:10px; opacity:0.6; cursor:pointer;" onclick="promptAdmin()">Panel Barbero</button>
        </div>
        <div class="social">
            <a class="social-btn" href="#"><img src="https://cdn-icons-png.flaticon.com/512/1384/1384063.png" width="20"></a>
            <a class="social-btn" href="#"><img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" width="20"></a>
        </div>
      </div>

      <div class="screen" id="login">
        <h2>Tus Datos</h2>
        <input id="nameInput" type="text" placeholder="NOMBRE">
        <input id="phoneInput" type="tel" placeholder="WHATSAPP">
        <button onclick="login()" style="margin-top:20px; width:280px">Continuar</button>
        <div class="nav"><button onclick="go('home')" class="secondary" style="font-size:11px">Cancelar</button></div>
      </div>

      <div class="screen" id="month">
        <h2>Selecciona el Mes</h2>
        <div class="grid" id="months" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;"></div>
        <div class="nav"><button onclick="go('home')" class="secondary">Inicio</button></div>
      </div>

      <div class="screen" id="day">
        <h2>D√≠a del Turno</h2>
        <div id="days" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;"></div>
        <div class="nav"><button onclick="go('month')" class="secondary">Atr√°s</button></div>
      </div>

      <div class="screen" id="tattooDetails">
        <h2>Elige el Servicio</h2>
        <div class="service-options" id="serviceOptions"></div>
        <div class="nav"><button onclick="go('day')" class="secondary">Atr√°s</button></div>
      </div>

      <div class="screen" id="hourSelection">
        <h2>Hora Disponible</h2>
        <div id="hoursGrid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;"></div>
        <div class="nav"><button onclick="go('tattooDetails')" class="secondary">Atr√°s</button></div>
      </div>

      <div class="screen" id="imageUploadScreen">
        <h2>Confirmaci√≥n</h2>
        <div style="text-align:center; padding: 20px; background: #f9f9f9; border: 1px solid #eee;">
          <p id="userTattooInfo" style="font-weight: 600; color: var(--navy);"></p>
          <p style="font-size: 12px; color: var(--text-muted);">Te enviaremos un recordatorio por WhatsApp.</p>
        </div>
        <button id="confirmBtn" onclick="confirmBooking()" style="width: 280px;">Confirmar Turno</button>
        <div class="nav"><button onclick="go('hourSelection')" class="secondary">Atr√°s</button></div>
      </div>

      <div class="screen" id="done">
        <h1 class="brand" style="font-size:30px">¬°Turno Agendado!</h1>
        <p style="color:var(--text-muted); text-align:center; font-size:14px;">Te esperamos en la fecha y hora seleccionada.</p>
        <button onclick="resetBookingFlow()">Finalizar</button>
      </div>

      <div class="screen" id="admin">
        <h2 style="margin-bottom:10px">Pr√≥ximas Citas</h2>
        <div id="adminList" style="width:100%; overflow-y:auto; flex:1; padding:5px;"></div>
        <button onclick="go('home')" class="secondary" style="margin-top:10px">Cerrar Panel</button>
      </div>

    </div>
  </section>

  <section class="about-section">
      <h2 style="color: var(--navy)">Nuestra Barber√≠a</h2>
      <p style="max-width: 600px; color: var(--text-muted); line-height: 1.8;">
        En <strong>Classic Blade</strong>, combinamos las t√©cnicas tradicionales de barber√≠a con las tendencias m√°s actuales. 
      </p>
  </section>
</div>

<script>
const SERVER_URL="/api/bookings"; 
const DURATIONS={ "corte": 1, "barba": 0.5, "combo": 1.5, "spa": 2 };

let selectedMonth, selectedDay, selectedService, selectedHour;
let bookings=[]; // Aqu√≠ se guardar√°n las citas locales y de la API

let userPhone = localStorage.getItem("whatsapp");
let userName = localStorage.getItem("userName");

function nowUY(){ return new Date(new Date().toLocaleString("en-US", {timeZone: "America/Montevideo"})); }

function go(id) { 
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active")); 
  document.getElementById(id).classList.add("active"); 
  if (id === 'imageUploadScreen') updateSummary(); 
  if (id === 'admin') renderAdmin();
}

function tryGoAgenda(){ 
    if(userPhone && userName) go("month");
    else go("login");
}

function login(){ 
    const name = document.getElementById("nameInput").value.trim();
    const phone = document.getElementById("phoneInput").value.trim();
    if(!name || phone.length < 8) return alert("Completa tus datos.");
    localStorage.setItem("userName", name);
    localStorage.setItem("whatsapp", phone);
    userName = name; userPhone = phone;
    go("month"); 
}

const MONTHS=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
const monthsEl=document.getElementById("months");
MONTHS.forEach((m,i)=>{ 
  const b=document.createElement("button"); 
  b.textContent=m; b.className="secondary";
  if(i < nowUY().getMonth()) b.disabled=true; 
  b.onclick=()=>{ selectedMonth=i; renderDays(); go('day'); }; 
  monthsEl.appendChild(b); 
});

function renderDays(){ 
  const daysEl = document.getElementById("days");
  daysEl.innerHTML=""; 
  const currentUY = nowUY();
  const daysInMonth=new Date(currentUY.getFullYear(),selectedMonth+1,0).getDate(); 
  for(let d=1;d<=daysInMonth;d++){ 
    const b=document.createElement("button"); 
    b.textContent=d; b.className="secondary";
    if(selectedMonth === currentUY.getMonth() && d < currentUY.getDate()) b.disabled = true;
    b.onclick=()=>{ selectedDay=d; renderServices(); go("tattooDetails"); }; 
    daysEl.appendChild(b); 
  } 
}

const SERVICES=[ 
  { id:"corte", label:"Corte Signature", price:"$500", img:"https://images.unsplash.com/photo-1585747860715-2ba37e788b70?w=400" }, 
  { id:"barba", label:"Perfilado de Barba", price:"$350", img:"https://images.unsplash.com/photo-1621605815841-aa33c5639a09?w=400" }, 
  { id:"combo", label:"Corte + Barba", price:"$750", img:"https://images.unsplash.com/photo-1503951914875-452162b0f3f1?w=400" }, 
  { id:"spa", label:"Limpieza Facial", price:"$400", img:"https://images.unsplash.com/photo-1590540179852-2110a54f813a?w=400" }
];

function renderServices(){ 
  const container=document.getElementById("serviceOptions"); container.innerHTML=""; 
  SERVICES.forEach(s=>{ 
    const card=document.createElement("div"); card.className="service-card"; 
    card.innerHTML=`<img src="${s.img}"><div class="info"><strong>${s.label}</strong><p style="color:var(--gold)">${s.price}</p></div>`; 
    card.onclick=()=>{ selectedService=s; renderHours(); go("hourSelection"); };
    container.appendChild(card); 
  }); 
}

function renderHours(){
  const grid=document.getElementById("hoursGrid"); grid.innerHTML=""; 
  const currentUY = nowUY();
  for(let h=9; h<=20; h++){
    let btn=document.createElement("button"); 
    btn.textContent=h+":00"; btn.className="secondary";
    if(selectedMonth === currentUY.getMonth() && selectedDay === currentUY.getDate()){
        if(h <= currentUY.getHours()) btn.disabled = true;
    }
    btn.onclick=()=> { selectedHour=h; go('imageUploadScreen'); };
    grid.appendChild(btn);
  }
}

function updateSummary() {
  document.getElementById("userTattooInfo").innerHTML = `SERVICIO: ${selectedService.label}<br>FECHA: ${selectedDay}/${selectedMonth+1}<br>HORA: ${selectedHour}:00hs`;
}

async function confirmBooking(){
  const btn = document.getElementById("confirmBtn");
  btn.disabled = true; btn.textContent = "PROCESANDO...";
  
  // Guardamos la cita en el array local para que aparezca en el panel admin
  const newBooking = {
      name: userName,
      phone: userPhone,
      service: selectedService.label,
      price: selectedService.price,
      date: `${selectedDay}/${selectedMonth+1}`,
      hour: `${selectedHour}:00hs`
  };
  bookings.push(newBooking);
  
  setTimeout(() => { go("done"); }, 1500);
}

function renderAdmin() {
    const list = document.getElementById("adminList");
    list.innerHTML = "";
    if(bookings.length === 0) {
        list.innerHTML = "<p style='color:#999; font-size:12px; margin-top:20px;'>No hay citas agendadas a√∫n.</p>";
        return;
    }
    bookings.forEach((b, index) => {
        const card = document.createElement("div");
        card.className = "admin-card";
        card.innerHTML = `
            <div class="admin-info-client">
                <strong>${b.name}</strong>
                <p>üìû ${b.phone}</p>
                <p>‚úÇÔ∏è ${b.service} (${b.price})</p>
                <p>üìÖ ${b.date} - üïí ${b.hour}</p>
            </div>
            <button onclick="window.open('https://wa.me/${b.phone.replace(/\D/g,'')}')" 
                    style="padding:10px; font-size:10px; background:#25D366; border:none;">
                WhatsApp
            </button>
        `;
        list.appendChild(card);
    });
}

function resetBookingFlow() { location.reload(); }

function promptAdmin(){
    const pass = prompt("Contrase√±a de acceso:");
    if(pass === "admin123") go("admin");
}
</script>
</body>
</html>